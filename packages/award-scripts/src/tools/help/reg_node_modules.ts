import * as os from 'os';

const cwd = process.cwd();
let reg = /\/node_modules\//;

if (os.type() === 'Windows_NT') {
  reg = /\\node_modules\\/;

  if (reg.test(cwd)) {
    // 当前项目在node_modules内
    const m = cwd.match(/\\node_modules\\(.*)\\?/);

    if (m) {
      // /\\node_modules\\(?!abc)\\/
      reg = new RegExp(`\\\\node_modules\\\\(?!${m[1]})\\\\`);
    }
  }
} else {
  if (reg.test(cwd)) {
    // 当前项目在node_modules内
    const m = cwd.match(/\/node_modules\/(.*)\/?/);

    if (m) {
      // /\/node_modules\/(?!abc)\//
      reg = new RegExp(`/node_modules/(?!${m[1]})/`);
    }
  }
}

export default reg;
